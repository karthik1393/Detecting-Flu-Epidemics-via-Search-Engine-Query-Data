library(zoo)
flutrain<-read.csv("FluTrain.csv")
str(flutrain)
View(flutrain)
which.max(flutrain$ILI)
flutrain[303,]
which.max(flutrain$Queries)
hist(flutrain$ILI)
log<-log(flutrain$ILI)
plot(flutrain$Queries,log)
reg_flu<-lm(log(ILI)~Queries,data=flutrain)
summary(reg_flu)
cor(log,flutrain$Queries)
flutest<-read.csv("FluTest.csv")
prediction<-exp(predict(reg_flu,newdata=flutest))
prediction[11]
subset(flutest,Week=="2012-03-11 - 2012-03-17")
sse=sum((prediction-flutest$ILI)^2)
rmse=sqrt(sse/nrow(flutest))
str(flutest)
ILIlag=lag(zoo(flutrain$ILI),-2,na.pad=TRUE)
flutrain$ILIlag=coredata(ILIlag)
str(flutrain)
summary(flutrain)
plot(log(flutrain$ILIlag),log(flutrain$ILI))
reg_trend<-lm(log(ILI)~log(ILIlag)+Queries,flutrain)
summary(reg_trend)
ILIlag=lag(zoo(flutest$ILI),-2,na.pad=TRUE)
flutest$ILIlag=coredata(ILIlag)
summary(flutest)
flutest$ILIlag[1]=flutrain$ILI[416]
flutest$ILIlag[2]=flutrain$ILI[417]
flutest[1:2,]
pr<-exp(predict(reg_trend,flutest))
sse<-sum((pr-flutest$ILI)^2)
rmse=sqrt(sse/nrow(flutest))
pr1<-exp(predict(reg_flu,flutest))
sse1<-sum((pr1-flutest$ILI)^2)
rmse1=sqrt(sse1/nrow(flutest))
rmse1
